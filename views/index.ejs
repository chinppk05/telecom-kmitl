<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>หน้าหลัก</title>

    <!-- CSS only -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />
    <!-- JavaScript Bundle with Popper -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
      crossorigin="anonymous"
    ></script>

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.6.0/font/bootstrap-icons.css"
    />

    <!--font-->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Prompt:wght@300&display=swap"
      rel="stylesheet"
    />


    <!-- Leaflet-->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
    integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI="
    crossorigin=""/>

     <!-- Make sure you put this AFTER Leaflet's CSS -->
 <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
 integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM="
 crossorigin=""></script>

 <!--Chart.JS-->
 <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>


    <style>
      .core {
        font-family: "Prompt", "sans-serif";
        height: 100%;
      }
    </style>
  </head>
  <body style="background-color: #edf2f6" class="core" onload="display_ct()">
    <div
      style="
        box-shadow: rgba(9, 30, 66, 0.25) 0px 4px 8px -2px,
          rgba(9, 30, 66, 0.08) 0px 0px 0px 1px;
        height: auto;
        border-radius: 40px;
        padding: 40px;
        margin: 10px;
        background-color: white;
      "
    >
      

      <div class="container-fluid">
        <div class="d-flex flex-row bd-highlight mb-3">
            <div  class="p-2 bd-highlight">
                <img
                src="/views/images/LKB.png"
                alt="สถาบันเทคโนโลยีพระจอมเกล้าเจ้าคุณทหารลาดกระบัง"
                style="width: 90px"
              />
            </div>
            <div  class="p-2 bd-highlight">
                <div style="font-size: 23px">
                    <span>สถาบันเทคโนโลยีพระจอมเกล้าเจ้าคุณทหารลาดกระบัง</span>
                  </div>
                  <div style="font-size: 18px">
                    <span>คณะวิศวกรรมศาสตร์ ภาควิชาวิศวกรรมโทรคมนาคม</span>
                  </div>
            </div>
        </div>
  
        <div class="d-flex justify-content-between">
            <div class="p-2 flex-fill bd-highlight">
                <div style="font-size: 15px;" class="d-flex justify-content-center"><i class="bi bi-clock"></i><span style="margin-left: 5px;">วันที่และเวลา</span></div>
                <div style="font-size: 30px;" class="d-flex justify-content-center"><span id="time-clock"> </span></div>
                <div style="font-size: 15px;" class="d-flex justify-content-center"><span id="time-date"> </span></div>
            </div>
            <div class="p-2 flex-fill bd-highlight">
                <div style="font-size: 15px;" class="d-flex justify-content-center"><span >Online </span><i class="bi bi-circle-fill" style="margin-left: 5px; color: mediumseagreen;" ></i></div>
                <div style="font-size: 30px;" class="d-flex justify-content-center"><span></span><span> 10</span></div>
                <div style="font-size: 15px;" class="d-flex justify-content-center"><span></span><span>Devices</span></div>
            </div> 
            <div class="p-2 flex-fill bd-highlight">
                <div style="font-size: 15px;" class="d-flex justify-content-center"><span >Offline</span><i class="bi bi-circle-fill" style="margin-left: 5px; color: grey;" ></i></div>
                <div style="font-size: 30px;" class="d-flex justify-content-center"><span></span><span> 3</span></div>
                <div style="font-size: 15px;" class="d-flex justify-content-center"><span></span><span>Devices</span></div>
            </div> 
            <div class="p-2 flex-fill bd-highlight">
                <div style="font-size: 15px;" class="d-flex justify-content-center"><span >Abnormal </span><i class="bi bi-circle-fill" style="margin-left: 5px; color: #FF0000;" ></i></div>
                <div style="font-size: 30px;" class="d-flex justify-content-center"><span></span><span> 2</span></div>
                <div style="font-size: 15px;" class="d-flex justify-content-center"><span></span><span>Devices</span></div>
            </div> 
            <div class="p-2 flex-fill bd-highlight">
                <div style="font-size: 15px;" class="d-flex justify-content-center"><span >ค่า DO สูงสุด</span></div>
                <div style="font-size: 30px;" class="d-flex justify-content-center"><span></span><span>5.3</span></div>
                <div style="font-size: 15px;" class="d-flex justify-content-center"><span></span><span>mg/L</span></div>
            </div> 
            <div class="p-2 flex-fill bd-highlight">
                <div style="font-size: 15px;" class="d-flex justify-content-center"><span >ค่า DO ต่ำสุด</span></i></div>
                <div style="font-size: 30px;" class="d-flex justify-content-center"><span></span><span>2.4</span></div>
                <div style="font-size: 15px;" class="d-flex justify-content-center"><span></span><span>mg/L</span></div>
            </div> 
            <div class="p-2 flex-fill bd-highlight">
                <div style="font-size: 15px;" class="d-flex justify-content-center"><span >ค่า DO เฉลี่ย</span></i></div>
                <div style="font-size: 30px;" class="d-flex justify-content-center"><span></span><span>1.1</span></div>
                <div style="font-size: 15px;" class="d-flex justify-content-center"><span></span><span>mg/L</span></div>
            </div> 
    

          </div>
      </div>
    </div>
<div class="container-fluid" style="height: 100;">
  <div class="row">
    <div class="col"
    style="
    box-shadow: rgba(9, 30, 66, 0.25) 0px 4px 8px -2px,
      rgba(9, 30, 66, 0.08) 0px 0px 0px 1px;
    height: auto;
    border-radius: 40px;
    padding: 40px;
    margin: 10px;
    background-color: white;
  ">
    <div style="margin-bottom: 10px;">
      <h5>แผนที่</h5>
    </div>
      <div id="map" style="height: 360px;"></div>
    </div>
    <div class="col"
    style="
    box-shadow: rgba(9, 30, 66, 0.25) 0px 4px 8px -2px,
      rgba(9, 30, 66, 0.08) 0px 0px 0px 1px;
    height: auto;
    border-radius: 40px;
    padding: 40px;
    margin: 10px;
    background-color: white;
  ">
      <div style="margin-bottom: 10px;">
        <h5>ข้อมูลประจำวัน</h5>
      </div>
      <div style="margin-bottom: 10px; height: 300px
      
      
      
      ;" class="d-flex justify-content-center">
        <canvas id="myChart"></canvas>
      </div>     
      <hr>
      
      <div class="d-flex justify-content-between">
    

        <div class="p-2 flex-fill bd-highlight">
            <div style="font-size: 15px;" class="d-flex justify-content-center"><span >ค่า DO ปัจจุบัน</span></div>
            <div style="font-size: 30px;" class="d-flex justify-content-center" id="do-now"><span></span><span>2.2</span></div>
            <div style="font-size: 15px;" class="d-flex justify-content-center"><span></span><span>mg/L</span></div>
        </div> 
        <div class="p-2 flex-fill bd-highlight">
            <div style="font-size: 15px;" class="d-flex justify-content-center"><span >ค่า DO สูงสุด</span></i></div>
            <div style="font-size: 30px;" class="d-flex justify-content-center"><span></span><span>2.4</span></div>
            <div style="font-size: 15px;" class="d-flex justify-content-center"><span></span><span>mg/L</span></div>
        </div> 
        <div class="p-2 flex-fill bd-highlight">
            <div style="font-size: 15px;" class="d-flex justify-content-center"><span >ค่า DO ต่ำสุด</span></i></div>
            <div style="font-size: 30px;" class="d-flex justify-content-center"><span></span><span>1.9</span></div>
            <div style="font-size: 15px;" class="d-flex justify-content-center"><span></span><span>mg/L</span></div>
        </div> 


      </div>
    </div>
  </div>
</div>
   

<script>
  // Set the minimum and maximum values for the range
const min = 1.8;
const max = 2.5;

// Create an empty array to store the random numbers
const randomNumbers = [];

// Generate 49 random numbers and add them to the array
for (let i = 0; i < 44; i++) {
  const randomNumber = Math.random() * (max - min) + min;
  randomNumbers.push(randomNumber);
}

  var ctx = document.getElementById("myChart").getContext("2d");
  var myChart = new Chart(ctx, {
    type: "line",
    data: {
      labels: [
        "00:00",
        "00:30",
        "01:00",
        "01:30",
        "02:00",
        "02:30",
        "03:00",
        "03:30",
        "04:00",
        "04:30",
        "05:00",
        "05:30",
        "06:00",
        "07:30",
        "08:00",
        "09:30",
        "10:00",
        "10:30",
        "11:00",
        "11:30",
        "12:00",
        "12:30",
        "13:00",
        "13:30",
        "14:00",
        "14:30",
        "15:00",
        "15:30",
        "16:00",
        "16:30",
        "17:00",
        "17:30",
        "18:00",
        "18:30",
        "19:00",
        "19:30",
        "20:00",
        "20:30",
        "21:00",
        "21:30",
        "22:00",
        "22:30",
        "23:00",
        "23:30"
      ],
      datasets: [
        {
          label: "ค่า DO",
          data: randomNumbers,
          backgroundColor: "rgba(255, 99, 132, 0.2)",
          borderColor: "blue",
          borderWidth: 2,
        },
      ],
    },
    options: {
      scales: {
        xAxes: [
          {
            type: "time",
            time: {
              unit: "hour",
              displayFormats: {
                hour: "hA",
              },
              stepSize: 1,
            },
            ticks: {
              autoSkip: true,
              maxTicksLimit: 48,
            },
          },
        ],
        yAxes: [
          {
            ticks: {
              beginAtZero: true,
            },
          },
        ],
      },
    },
  });
</script>
<script>
  // create a map object
var mymap = L.map('map').setView([13.727450595911504, 100.77611550372163],17);

// add a tile layer to the map
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors',
  maxZoom: 18
}).addTo(mymap);

// add a marker to the map
//var marker = L.marker([13.727450595911504, 100.77611550372163]).addTo(mymap);

// add a popup to the marker
//marker.bindPopup("<b>ตึกโทรคม</b><br>KMITL.").openPopup();

var redIcon = L.icon({
  iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png',
  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
  iconSize: [25, 41],
  iconAnchor: [12, 41],
  popupAnchor: [1, -34],
  shadowSize: [41, 41]
});

var greenIcon = L.icon({
  iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png',
  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
  iconSize: [25, 41],
  iconAnchor: [12, 41],
  popupAnchor: [1, -34],
  shadowSize: [41, 41]
});

var marker = L.marker([13.727450595911504, 100.77611550372163],{icon: greenIcon}).addTo(mymap);
var marker = L.marker([13.72749846948603, 100.77530646955644], {icon: redIcon}).addTo(mymap);
var marker = L.marker([13.727027712245551, 100.77635780329396], {icon: redIcon}).addTo(mymap);



var ws = new WebSocket('ws://' + window.location.hostname + ':9090');
ws.onmessage = function(event) {
        var message = JSON.parse(event.data);
        document.getElementById('do-now').innerHTML = message.do.toFixed(2);
      };
</script>


    <script src="/views/js/refreshtime.js"></script>
    <script src="/views/js/showtime.js"></script>
  </body>
</html>
